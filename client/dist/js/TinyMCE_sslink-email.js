!function(){"use strict";var t={207:function(t){t.exports=Injector},127:function(t){t.exports=InsertLinkModal},594:function(t){t.exports=React},145:function(t){t.exports=ReactDomClient},153:function(t){t.exports=TinyMCEActionRegistrar},815:function(t){t.exports=i18n},669:function(t){t.exports=jQuery}},e={};function i(n){var r=e[n];if(void 0!==r)return r.exports;var o=e[n]={exports:{}};return t[n](o,o.exports,i),o.exports}!function(){var t=s(i(815)),e=s(i(153)),n=s(i(594)),r=i(145),o=s(i(669)),a=i(127),l=i(207);function s(t){return t&&t.__esModule?t:{default:t}}const d="sslinkemail",c={init(i){e.default.addAction("sslink",{text:t.default._t("Admin.LINKLABEL_EMAIL","Link to email address"),onAction:t=>t.execCommand(d),priority:51},i.getParam("editorIdentifier")).addCommandWithUrlTest(d,/^mailto:/),i.addCommand(d,(()=>{window.jQuery(`#${i.id}`).entwine("ss").openLinkEmailDialog()}))}},u="insert-link__dialog-wrapper--email",m=(0,l.loadComponent)((0,a.createInsertLinkModal)("SilverStripe\\Admin\\LeftAndMain","EditorEmailLink"));o.default.entwine("ss",(e=>{e("textarea.htmleditor").entwine({openLinkEmailDialog(){let t=e(`#${u}`);t.length||(t=e(`<div id="${u}" />`),e("body").append(t)),t.addClass("insert-link__dialog-wrapper"),t.setElement(this),t.open()}}),e(`#${u}`).entwine({ReactRoot:null,renderModal(e){var i=this;const o=this.getOriginalAttributes(),a=this.getRequireLinkText();let l=this.getReactRoot();l||(l=(0,r.createRoot)(this[0]),this.setReactRoot(l)),l.render(n.default.createElement(m,{isOpen:e,onInsert:function(){return i.handleInsert(...arguments)},onClosed:()=>this.close(),title:t.default._t("Admin.LINK_EMAIL","Insert email link"),bodyClassName:"modal__dialog",className:"insert-link__dialog-wrapper--email",fileAttributes:o,identifier:"Admin.InsertLinkEmailModal",requireLinkText:a}))},getOriginalAttributes(){const t=this.getElement().getEditor(),i=e(t.getSelectedNode()),n=(i.attr("href")||"").split("?");let r=n[0].replace(/^mailto:/,"").split("?")[0];r.match(/.+@.+\..+/)||(r="");const o=n[1]?n[1].match(/subject=([^&]+)/):"";return{Link:r,Subject:o?decodeURIComponent(o[1]):"",Description:i.attr("title")}},buildAttributes(t){const e=this._super(t);let i="",n=e.href.replace(/^mailto:/,"").split("?")[0];return n.match(/.+@.+\..+/)||(n=""),n&&(i=`mailto:${n}`),i&&t.Subject&&(i=`${i}?subject=${encodeURIComponent(t.Subject)}`),e.href=i,delete e.target,e}})})),tinymce.PluginManager.add(d,(t=>c.init(t)))}()}();